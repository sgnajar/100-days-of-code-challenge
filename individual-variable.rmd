---
output: html_document
editor_options: 
  chunk_output_type: console
---
# SasanNajar 
# Email: sasangnajar@gmail.com, Twitter:@SasanGN

```{r}
library(ggplot2)
library(gridExtra)
library(scales)
library(dplyr)


```

## how many observations are in the dataset?
```{r}
nrow(diamonds)
```

## how many variables are in the dataset?
```{r}
ncol(diamonds)
```

## how many ordered factors are in the set?
```{r}
str(diamonds)
summary(diamonds)
```

## what letter represents the best color for a diamonds?
```{r}
levels(diamonds$color)
```

# Create a histogram of the price of all the diamonds in the diamond data set.
```{r}
ggplot(diamonds, aes(x = price)) + 
  geom_histogram(color = "black", fill = "green", binwidth = 1000) + 
  scale_x_continuous(breaks = seq(0, 20000, 1000)) + 
  theme(axis.text.x = element_text(angle = 90)) + 
  xlab("Price") + 
  ylab("Count")
```

## explore the largest peak in the price histogram
```{r}
ggplot(diamonds, aes(x = price)) + 
  geom_histogram(color = "black", fill = "green", binwidth = 25) + 
  scale_x_continuous(labels=dollar, breaks = seq(0, 2000, 100)) + 
  theme(axis.text.x = element_text(angle = 90)) +
  coord_cartesian(c(0,2000))
xlab("Price") + 
  ylab("Count")
```

## Break out the histogram of diamond prices by cut. five histograms in separate panels.

```{r}
ggplot(diamonds, aes(x = price)) + 
  geom_histogram(color = "black", fill = "blue", binwidth = 25) + 
  scale_x_continuous(labels = dollar, breaks = seq(0, 4000, 100)) + 
  theme(axis.text.x = element_text(angle = 90)) + 
  coord_cartesian(c(0,4000)) +
  facet_grid(cut~.) + 
  xlab("Price") + ylab("Count")
```

## describe the shape and center of the price distribution
```{r}
summary(diamonds)
```

## how many diamonds cost less than $800
## how many cost less than $350
## how many cost $10K or more

```{r}
sum(diamonds$price < 800)
sum(diamonds$price < 350)
sum(diamonds$price >= 10000)
```

## which cut has the highest priced diamond?
```{r}
by(diamonds$price, diamonds$cut, max)
by(diamonds$price, diamonds$cut, min)
by(diamonds$price, diamonds$cut, median)
```

```{r}
diamonds %>%
  group_by(cut) %>%
  summarise(max_price = max(price),
            min_price = min(price),
            median_price = median(price))
```


qplot(x = price, data = diamonds) + facet_wrap(~cut, scales = "free")
summary(diamonds$cut)


## histogram of price per carat and facet it by cut..
## adjust the bin width and tranform the scale of the x-axis using log10
## for long tailed distributions, used scale_x_log10 to transform the variable. 
```{r}
ggplot(diamonds, aes(x = price/carat)) + 
  geom_histogram(color = "dark blue", fill = "blue", binwidth = .05) + 
  theme(axis.text.x = element_text(angle = 0)) +
  scale_x_log10(expression(paste(Log[10], " of Price")),
                breaks = trans_breaks("log10", function(x) 10^x),
                labels = trans_format("log10", math_format(10^.x))) + 
  facet_grid(cut~., scale = "free") + ylab("Count")
```



