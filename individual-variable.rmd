---
output: html_document
editor_options: 
  chunk_output_type: console
---
# SasanNajar 
# Email: sasangnajar@gmail.com, Twitter:@SasanGN

```{r}
library(ggplot2)
library(gridExtra)
library(scales)
library(dplyr)
## dplyr - a package that helps you transform tidy, tabular data
```

## how many observations are in the dataset?
```{r}
nrow(diamonds)
```

## how many variables are in the dataset?
```{r}
ncol(diamonds)
```

## how many ordered factors are in the set?
```{r}
str(diamonds)
summary(diamonds)
```

## what letter represents the best color for a diamonds?
```{r}
levels(diamonds$color)
```

# Create a histogram of the price of all the diamonds in the diamond data set.
```{r}
ggplot(diamonds, aes(x = price)) + 
  geom_histogram(color = "black", fill = "green", binwidth = 1000) + 
  scale_x_continuous(breaks = seq(0, 20000, 1000)) + 
  theme(axis.text.x = element_text(angle = 90)) + 
  xlab("Price") + 
  ylab("Count")
```

## explore the largest peak in the price histogram
```{r}
ggplot(diamonds, aes(x = price)) + 
  geom_histogram(color = "black", fill = "green", binwidth = 25) + 
  scale_x_continuous(labels=dollar, breaks = seq(0, 2000, 100)) + 
  theme(axis.text.x = element_text(angle = 90)) +
  coord_cartesian(c(0,2000))
xlab("Price") + 
  ylab("Count")
```

## Break out the histogram of diamond prices by cut. five histograms in separate panels.

```{r}
ggplot(diamonds, aes(x = price)) + 
  geom_histogram(color = "black", fill = "blue", binwidth = 25) + 
  scale_x_continuous(labels = dollar, breaks = seq(0, 4000, 100)) + 
  theme(axis.text.x = element_text(angle = 90)) + 
  coord_cartesian(c(0,4000)) +
  facet_grid(cut~.) + 
  xlab("Price") + ylab("Count")
```

## describe the shape and center of the price distribution
```{r}
summary(diamonds)
```

## how many diamonds cost less than $800
## how many cost less than $350
## how many cost $10K or more

```{r}
sum(diamonds$price < 800)
sum(diamonds$price < 350)
sum(diamonds$price >= 10000)
```

## which cut has the highest priced diamond?
```{r}
by(diamonds$price, diamonds$cut, max)
by(diamonds$price, diamonds$cut, min)
by(diamonds$price, diamonds$cut, median)
```
## or
```{r}
diamonds %>%
  group_by(cut) %>%
  summarise(max_price = max(price),
            min_price = min(price),
            median_price = median(price))
```

```{r}
qplot(x = price, data = diamonds) + facet_wrap(~cut, scales = "free")
summary(diamonds$cut)
```

## histogram of price per carat and facet it by cut..
## adjust the bin width and tranform the scale of the x-axis using log10
## for long tailed distributions, used scale_x_log10 to transform the variable. 
```{r}
ggplot(diamonds, aes(x = price/carat)) + 
  geom_histogram(color = "dark blue", fill = "blue", binwidth = .05) + 
  theme(axis.text.x = element_text(angle = 0)) +
  scale_x_log10(expression(paste(Log[10], " of Price")),
                breaks = trans_breaks("log10", function(x) 10^x),
                labels = trans_format("log10", math_format(10^.x))) + 
  facet_grid(cut~., scale = "free") + ylab("Count")
```


## investigate the price of diamonds using box plots, numerical summaries, and one categorical variables (cut/clarity/color)
```{r}
ggplot(diamonds, aes(x = clarity, y = price, color = cut)) + 
  geom_boxplot() + 
  facet_grid(color~., margins = TRUE) 

diamonds %>%
  group_by(cut) %>%
  summarise(count = n(), 
            avg_price = mean(price))
```
# This boxplot matrix shows the distribution of price across all 3 categorical variables; cut, clarity, and color.

## the price range for the middle 50% of the diamonds with color D
```{r}
IQR(subset(diamonds, price <1000)$price)

diamonds %>%
  group_by(color) %>%
  filter(color == "D") %>%
  summarise(Q1 = quantile(price, 0.25),
            Q2 = quantile(price, 0.50),
            Q3 = quantile(price, 0.75),
            IQR = Q3 - Q1)
```

## the price range for the middle 50% of the diamonds with color J.
```{r}
IQR(subset(diamonds, price <1000)$price)

diamonds %>%
  group_by(color) %>%
  filter(color == "J") %>%
  summarise(Q1 = quantile(price, 0.25),
            Q2 = quantile(price, 0.50),
            Q3 = quantile(price, 0.75),
            IQR = Q3 - Q1)
```

```{r}
by(diamonds$price, diamonds$color, summary)
```

# investigate the price per carat of diamonds across the different colors of diamonds using boxplots.
```{r}
ggplot(diamonds, aes(x = color, y = price/carat, fill = color)) +
  geom_boxplot() +
  coord_cartesian(ylim=c(1000, 6000)) +
  scale_y_continuous(labels=dollar) + 
  xlab("Color") + ylab("Price per Carat")
```

## investigate the weight of the diamonds (carat) using a freq polygon
## using different bin widths to see how freq polygon changes.
## what carat size has a count greater than 2000

```{r}
summary(diamonds$carat)
sizes = c(0.1, 0.3, 0.8, 1.01, 1.6, 2.0, 3.0, 5.0)

ggplot(diamonds, aes(x=carat)) + 
  geom_freqpoly(binwidth=0.1, alpha = 0.75) + 
  scale_x_continuous(breaks=sizes, expand = c(0,0)) +
  scale_y_continuous(expand=c(0,0))+
  geom_vline(xintercept = c(0.1, 0.8, 1.6, 2.0, 3.0, 5.0), color = "red", linetype="dashed", alpha = 0.75) +
  geom_vline(xintercept = c(0.3, 1.01), color = "dark green", linetype = "twodash") +
  geom_hline(yintercept = 2000, color = "blue", linetype="longdash", alpha = 0.5) + 
  xlab("Carat Size") + ylab("Count")

```

## tidyr - a package that reshapes the layout of your data ...